/**
 * pushbullet-tasker.js
 *
 * Version: 1.0.2
 * Date: 2016-07-23
 *
 * Â© 2016 Cristian Moncho Ivorra
 * @license https://www.gnu.org/licenses/lgpl-3.0.txt
 */

if("undefined"==typeof tk)var tk={local:function(){},global:function(){},flashLong:(window.console||{}).log||function(){}};var PB=function(e,t){"use strict";function n(n,r){var o=l("POST",f,{"Access-Token":a.token});if(r.type=n,o.send(i(r)),a.debug&&e.flashLong(o.responseText),o.status!==b.OK)throw new t.Error("Unable to push data: "+o.status);return o.responseText}function r(n,r){var o=l("POST",d,{"Access-Token":a.token});if(o.send(i({file_name:n,file_type:r})),a.debug&&e.flashLong(o.responseText),o.status!==b.OK)throw new t.Error("Unable to request upload URL: "+o.status);return JSON.parse(o.responseText)}function o(e){var n=l("GET",e);n.overrideMimeType("text/plain; charset=x-user-defined"),n.send();for(var r=n.responseText,o=new t.Uint8Array(r.length),u=0,i=r.length;i>u;u++)o[u]=r.charCodeAt(u);return new t.Blob([o])}function u(e,n,u){var s=r(e,n),a=l("POST",s.upload_url);if(a.send(i({file:o(u)})),a.status!==b.NO_CONTENT)throw new t.Error("Unable to upload file: "+a.status);return s.file_url}function i(e){var n=new t.FormData;for(var r in e)e.hasOwnProperty(r)&&n.append(r,e[r]);return n}function l(e,n,r){var o=new t.XMLHttpRequest;o.open(e.toUpperCase(),n,!1);for(var u in r||{})r.hasOwnProperty(u)&&o.setRequestHeader(u,r[u]);return o}function s(n,r){var o;if([t[n],e.local(n.toLowerCase()),e.global(n.toUpperCase()),r].some(function(e){return"undefined"!==e&&"undefined"!=typeof(o=e)}),"undefined"==typeof o)throw new t.Error('Undefined variable "'+n+'"!');return o}var a={},p="https://api.pushbullet.com/v2/",f=p+"pushes",d=p+"upload-request",b={OK:200,NO_CONTENT:204,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404};a.debug=s("pb_debug",!1),a.token=s("pb_token",null),a.pushNote=function(e){return e=e||{},n("note",{title:e.title||s("pb_title",""),body:e.body||s("pb_body","")})},a.pushLink=function(e){return e=e||{},n("link",{title:e.title||s("pb_title",""),body:e.body||s("pb_body",""),url:e.url||s("pb_url")})},a.pushFile=function(e){e=e||{};var t=e.file_name||s("pb_file_name"),r=e.file_path||s("pb_file_path"),o=e.file_type||s("pb_file_type");return n("file",{title:e.title||s("pb_title",""),body:e.body||s("pb_body",""),file_name:t,file_type:o,file_url:u(t,o,r)})};var _=s("pb_type",null);return _&&({note:a.pushNote,link:a.pushLink,file:a.pushFile}[_]||function(){throw Error('Unknown type: "'+_+'"!')})(),a}(tk,this);
